# encoding: utf8

from django.conf import settings as django_settings
from django.apps import apps


django_settings.configure(**{
    'DATABASES': {
        'default': {
            'ENGINE': 'django.db.backends.mysql',
            "USER": "root",
            "PASSWORD": "12345678",
            "HOST": "localhost",
            "PORT": 3306,
            'NAME': "erda",
            "CHARSET":'utf8mb4,utf8',
        },
    },
    "DEBUG": True,
    "TIME_ZONE": 'Asia/Shanghai',
    "INSTALLED_APPS": ["feature"],
})
apps.populate(django_settings.INSTALLED_APPS)

from datetime import datetime
import django.db.models


class Questions(django.db.models.Model):
    """
    generated by erda-cli migrate init
    """

    question_text = django.db.models.CharField(max_length=20)
    pub_date = django.db.models.DateTimeField("date published")

    class Meta:
        db_table = "polls_questions"


class Choice(django.db.models.Model):
    id = django.db.models.BigIntegerField()
    choice_text = django.db.models.CharField(max_length=20)

    class Meta:
        db_table = "polls_choice"


class Second(django.db.models.Model):
    choice_text = django.db.models.CharField()


def add_question():
    questions = Questions()
    questions.question_text = "the first question"
    questions.pub_date = datetime.now()
    questions.save(force_insert=True)


def add_choice():
    all_choice = Choice.objects.filter()
    print("all choice:", all_choice)
    for choice in all_choice:
        print(choice.id, choice.choice_text)
    choice = Choice()
    choice.choice_text = "this is a choice this is a choice this is a choice this is a choice this is a choice"
    choice.save()


entries: [callable] = [
    add_question,
    add_choice,
]
